{"compress":true,"commitItems":[["10cfbd43-408a-48d3-a9ba-27bf7cdcc960",1534401240569,"# Centos 系统swap虚拟内存添加与删除配置\n\n2014年12月24日 21:20:26\n\n阅读数：5010\n\n1.swap概述\n\n    Swap分区，即交换区，Swap空间的作用可简单描述为：当系统的物理内存不够用的时候，就需要将物理内存中的一部分空间释放出来，以供当前运行的程序使用。那些被释放的空间可能来自一些很长时间没有什么操作的程序，这些被释放的空间被临时保存到Swap空间中，等到那些程序要运行时，再从Swap中恢复保存的数据到内存中。这样，系统总是在物理内存不够时，才进行Swap交换。 其实，Swap的调整对Linux服务器，特别是Web服务器的性能至关重要。通过调整Swap，有时可以越过系统性能瓶颈，节省系统升级费用。\n\n2.创建swap\n\n[forlong401@dfdsfdsfs ~]# cd /var/\n\n获取要增加的SWAP文件块\n\n[forlong401@dfdsfdsfs var]# dd if=/dev/zero of=swapfile bs=1024 count=2048000\n\n记录了2048000+0 的读入\n\n记录了2048000+0 的写出\n\n2097152000字节(2.1 GB)已复制，61.357 秒，34.2 MB/秒\n\n创建SWAP文件\n\n[forlong401@dfdsfdsfs var]# mkswap swapfile\n\nmkswap: swapfile: warning: don't erase bootbits sectors\n\n        on whole disk. Use -f to force.\n\nSetting up swapspace version 1, size = 2047996 KiB\n\nno label, UUID=fdafdsfdsb-3sfdb-4sfdc-bfdfd7-8sdfsafds89\n\n激活SWAP文件\n\n[forlong401@dfdsfdsfs var]# swapon swapfile\n\n查看SWAP信息是否正确\n\n[forlong401@dfdsfdsfs var]# swapon -s\n\nFilename  Type  Size  Used  Priority\n\n/var/swapfile                           file  2047996  0  -1\n\n添加到fstab文件中让系统引导时自动启动\n\n[forlong401@dfdsfdsfs var]# echo \"/var/swapfile swap swap defaults 0 0\">>/etc/fstab\n\n[forlong401@dfdsfdsfs var]# free -m\n\n             total       used       free     shared    buffers     cached\n\nMem:           488        478         10          0          4        132\n\n-/+ buffers/cache:        341        147\n\nSwap:         1999          0       1999\n\n[forlong401@dfdsfdsfs var]# top -a\n\ntop - 21:04:55 up 3 days, 21:06,  2 users,  load average: 0.05, 0.25, 0.13\n\nTasks: 113 total,   1 running, 112 sleeping,   0 stopped,   0 zombie\n\nCpu(s):  0.3%us,  0.0%sy,  0.0%ni, 99.7%id,  0.0%wa,  0.0%hi,  0.0%si,  0.0%st\n\nMem:    52423423k total,   424234232k used,     942343k free,     523424k buffers\n\nSwap:  2047996k total,        0k used,  2047996k free,   136088k cached\n\n3.删除swap分区\n\n       有时可能会需要删除swap分区，该如何正确进行删除分区哪?\n\n*   首先停止swap分区\n\n    1.  swapoff   /swap/swap\n\n*   删除swap分区文件\n\n    1.  rm -rf /swap/swap\n\n*   删除\"/etc/swap\"指定文件\n\n    1.  sed  -i \"/'\\/swa\\/swap   swap   swap  defaults 0 0'//\" /etc/fstab\n\n     这样就可以手工添加和删除swap分区。",[[1534401222567,["Administrator@Tielemao",[[-1,28,"2014年12月24日 21:20:26\n\n阅读数：5010"]],[28,58],[28,28]]],[1534401222972,["Administrator@Tielemao",[[-1,29,"\n"]],[28,28],[27,27]]],[1534401224075,["Administrator@Tielemao",[[-1,28,"\n"]],[28,28],[27,27]]],[1534401237494,["Administrator@Tielemao",[[1,28,"\n"]],[27,27],[28,28]]],[1534401240237,["Administrator@Tielemao",[[1,28,"https://blog.csdn.net/forlong401/article/details/42129175"]],[28,28],[85,85]]],[1534401240885,["Administrator@Tielemao",[[1,86,"\n"]],[85,85],[86,86]]]],null,"Administrator@Tielemao"]]}